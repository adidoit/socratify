---
title: "A New Ranking Framework for Better Notification Quality on Instagram"
author: "Xian Sun"
url: "https://engineering.fb.com/2025/09/02/ml-applications/a-new-ranking-framework-for-better-notification-quality-on-instagram/"
date: "2025-09-15"
---

![](https://engineering.fb.com/wp-content/uploads/2022/06/Eng-Blog-Self-Serve-Hero-Images-PRIVACY-101-Navy.jpg)

By [Xian Sun](https://engineering.fb.com/author/xian-sun/ "Posts by Xian Sun"), [Shawn Pachgade](https://engineering.fb.com/author/shawn-pachgade/ "Posts by Shawn Pachgade"), [Abhishek Mandal](https://engineering.fb.com/author/abhishek-mandal/ "Posts by Abhishek Mandal"), [Christopher Hay](https://engineering.fb.com/author/christopher-hay/ "Posts by Christopher Hay"), [Nimit Desai](https://engineering.fb.com/author/nimit-desai/ "Posts by Nimit Desai"), [Zhuoran Yu](https://engineering.fb.com/author/zhuoran-yu/ "Posts by Zhuoran Yu")

* We‚Äôre sharing how Meta is applying machine learning (ML) and diversity algorithms to improve notification quality and user experience.
* We‚Äôve introduced a diversity-aware notification ranking framework to reduce uniformity and deliver a more varied and engaging mix of notifications.
* This new framework reduces the volume of notifications and drives higher engagement rates through more diverse outreach.

Notifications are one of the most powerful tools for bringing people back to Instagram and enhancing engagement. Whether it‚Äôs a friend liking your photo, another close friend posting a story, or a suggestion for a reel you might enjoy, notifications help surface moments that matter in real time.

Instagram leverages machine learning (ML) models to decide who should get a notification, when to send it, and what content to include. These models are trained to optimize for user positive engagement such as click-through-rate (CTR) ‚Äì the probability of a user clicking a notification ‚Äì as well as other metrics like time spent.

However, while engagement-optimized models are effective at driving interactions, there‚Äôs a risk that they might overprioritize the product types and authors someone has previously engaged with. This can lead to overexposure to the same creators or the same product types while overlooking other valuable and diverse experiences.

This means people could miss out on content that would give them a more balanced, satisfying, and enriched experience. Over time, this can make notifications feel spammy and increase the likelihood that people will disable them altogether.

The real challenge lies in finding the right balance: How can we introduce meaningful diversity into the notification experience without sacrificing the personalization and relevance people on Instagram have come to expect?

To tackle this, we‚Äôve introduced a diversity-aware notification ranking framework that helps deliver more diverse, better curated, and less repetitive notifications. This framework has significantly reduced daily notification volume while improving CTR. It also introduces several benefits:

* The extensibility of incorporating customized soft penalty (demotion) logic for each dimension, enabling more adaptive and sophisticated diversity strategies.
* The flexibility of tuning demotion strength across dimensions like content, author, and product type via adjustable weights.
* The integration of balancing personalization and diversity, ensuring notifications remain both relevant and varied.

## The Risks of Notifications without Diversity

The issue of overexposure in notifications often shows up in two major ways:

**Overexposure to the same author:**People might receive notifications that are mostly about the same friend. For example, if someone often interacts with content from a particular friend, the system may continue surfacing notifications from that person alone ‚Äì ignoring other friends they also engage with. This can feel repetitive and one-dimensional, reducing the overall value of notifications.

**Overexposure to the same product surface:**People might mostly receive notifications from the same product surface such as Stories, even when Feed or Reels could provide value. For example, someone may be interested in both reel and story notifications but has recently interacted more often with stories. Because the system heavily prioritizes past engagement, it sends only story notifications, overlooking the person‚Äôs broader interests.

## Introducing Instagram‚Äôs Diversity-Aware Notification Ranking Framework

Instagram‚Äôs diversity-aware notification ranking framework is designed to enhance the notification experience by balancing the predicted potential for user engagement with the need for content diversity. This framework introduces a diversity layer on top of the existing engagement ML models, applying multiplicative penalties to the candidate scores generated by these models, as figure1, below, shows.

The diversity layer evaluates each notification candidate‚Äôs similarity to recently sent notifications across multiple dimensions such as content, author, notification type, and product surface. It then applies carefully calibrated penalties‚Äîexpressed as multiplicative demotion factors‚Äîto downrank candidates that are too similar or repetitive. The adjusted scores are used to re-rank the candidates, enabling the system to select notifications that maintain high engagement potential while introducing meaningful diversity. In the end, the quality bar selects the top-ranked candidate that passes both the ranking and diversity criteria.

![](https://engineering.fb.com/wp-content/uploads/2025/09/A-new-ranking-framework-for-better-notification-quality-on-Instagram.png)Figure.1: Instagram‚Äôs diversity-aware ranking framework where the diversity layer sits on top of the existing modeling layer and penalizes notifications that are too similar to recently sent ones.

### Mathematical Formulation

Within the diversity layer, we apply a multiplicative demotion factor to the base relevance score of each candidate. Given a notification candidate ùëê, we compute its final score as the product of its base ranking score and a diversity demotion multiplier:

_![\\text{Score}\(c\) = R\(c\) \\times D\(c\) ](https://s0.wp.com/latex.php?latex=%5Ctext%7BScore%7D%28c%29+%3D+R%28c%29+%5Ctimes+D%28c%29+&bg=ffffff&fg=000&s=0&c=20201002)
_

where _R(c)_ represents the candidate‚Äôs base relevance score, and _D(c) ‚àà [0,1]_ is a penalty factor that reduces the score based on similarity to recently sent notifications. We define a set of semantic dimensions (e.g., author, product type) along which we want to promote diversity. For each dimension _i,_ we compute a similarity signal _p_ _i_ _(c)_ between candidate _c_ and the set of historical notifications _H_ , using a maximal marginal relevance (MMR) approach:

_![p_i\(c\) = \\mathrm{max}_{h \\in H}\\mathrm{sim}_i\(c, h\) ](https://s0.wp.com/latex.php?latex=p_i%28c%29+%3D+%5Cmathrm%7Bmax%7D_%7Bh+%5Cin+H%7D%5Cmathrm%7Bsim%7D_i%28c%2C+h%29+&bg=ffffff&fg=000&s=0&c=20201002)_

where _sim_ _i_ _(¬∑,¬∑)_ is a predefined similarity function for dimension i. In our baseline implementation, p _i_ _(c)_ is binary: it equals 1 if the similarity exceeds a threshold _ùúè_ _i_ and _0_ otherwise.

The final demotion multiplier is defined as:

_![D\(c\) = \\prod_{i=1}^{m} \\left\( 1 - w_i \\cdot p_i\(c\) \\right\) ](https://s0.wp.com/latex.php?latex=D%28c%29+%3D+%5Cprod_%7Bi%3D1%7D%5E%7Bm%7D+%5Cleft%28+1+-+w_i+%5Ccdot+p_i%28c%29+%5Cright%29+&bg=ffffff&fg=000&s=0&c=20201002)
_

where each _w_ _i_ _‚àà [0,1]_ controls the strength of demotion for its respective dimension. This formulation ensures that candidates similar to previously delivered notifications along one or more dimensions are proportionally down-weighted, reducing redundancy and promoting content variation. The use of a multiplicative penalty allows for flexible control across multiple dimensions, while still preserving high-relevance candidates.

## The Future of Diversity-Aware Ranking

As we continue evolving our notification diversity-aware ranking system, a next step is to introduce more adaptive, dynamic demotion strategies. Instead of relying on static rules, we plan to make demotion strength responsive to notification volume and delivery timing. For example, as a user receives more notifications‚Äîespecially of similar type or in rapid succession‚Äîthe system progressively applies stronger penalties to new notification candidates, effectively mitigating overwhelming experiences caused by high notification volume or tightly spaced deliveries.

Longer term, we see an opportunity to bring large language models (LLMs) into the diversity pipeline. LLMs can help us go beyond surface-level rules by understanding semantic similarity between messages and rephrasing content in more varied, user-friendly ways. This would allow us to personalize notification experiences with richer language and improved relevance while maintaining diversity across topics, tone, and timing.

### Share this:

* [ Click to share on Facebook (Opens in new window) Facebook ](https://engineering.fb.com/2025/09/02/ml-applications/a-new-ranking-framework-for-better-notification-quality-on-instagram/?share=facebook)
* [ Click to share on Threads (Opens in new window) Threads ](https://engineering.fb.com/2025/09/02/ml-applications/a-new-ranking-framework-for-better-notification-quality-on-instagram/?share=custom-1706294701)
* [ Click to share on X (Opens in new window) X ](https://engineering.fb.com/2025/09/02/ml-applications/a-new-ranking-framework-for-better-notification-quality-on-instagram/?share=x)
* [ Click to share on LinkedIn (Opens in new window) LinkedIn ](https://engineering.fb.com/2025/09/02/ml-applications/a-new-ranking-framework-for-better-notification-quality-on-instagram/?share=linkedin)
* [ Click to share on Hacker News (Opens in new window) Hacker News ](https://engineering.fb.com/2025/09/02/ml-applications/a-new-ranking-framework-for-better-notification-quality-on-instagram/?share=custom-1699562127)
* [ Click to email a link to a friend (Opens in new window) Email ](mailto:?subject=%5BShared%20Post%5D%20A%20New%20Ranking%20Framework%20for%20Better%20Notification%20Quality%20on%20Instagram&body=https%3A%2F%2Fengineering.fb.com%2F2025%2F09%2F02%2Fml-applications%2Fa-new-ranking-framework-for-better-notification-quality-on-instagram%2F&share=email)
*
